{"ast":null,"code":"import _regeneratorRuntime from\"/home/gmr/guiminr/E-Commerce-React/ecommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/gmr/guiminr/E-Commerce-React/ecommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/gmr/guiminr/E-Commerce-React/ecommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Paper,Stepper,Step,StepLabel,Typography,CircularProgress,Divider,Button,CssBaseline}from'@material-ui/core';import{Link,useHistory}from'react-router-dom';import{commerce}from'../../../lib/commerce';import useStyles from'./styles';import AddressForm from'../AddressForm';import PaymentForm from'../PaymentForm';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var steps=['Shipping address','Payment details'];var Checkout=function Checkout(_ref){var cart=_ref.cart,order=_ref.order,onCaptureCheckout=_ref.onCaptureCheckout,error=_ref.error;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),activeStep=_useState2[0],setActiveStep=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),checkoutToken=_useState4[0],setCheckoutToken=_useState4[1];var classes=useStyles();var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),shippingData=_useState6[0],setShippingData=_useState6[1];var history=useHistory();var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isFinished=_useState8[0],setIsFinished=_useState8[1];useEffect(function(){var generateToken=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var token;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return commerce.checkout.generateToken(cart.id,{type:'cart'});case 3:token=_context.sent;setCheckoutToken(token);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);history.pushState('/');case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function generateToken(){return _ref2.apply(this,arguments);};}();generateToken();},[cart]);var nextStep=function nextStep(){return setActiveStep(function(prevActiveStep){return prevActiveStep+1;});};var backStep=function backStep(){return setActiveStep(function(prevActiveStep){return prevActiveStep-1;});};var next=function next(data){setShippingData(data);nextStep();};var timeout=function timeout(){setTimeout(function(){setIsFinished(true);},3000);};var Confirmation=function Confirmation(){return order.customer?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",children:[\"Thank you! \",order.customer.firstname,\" \",order.customer.lastname]}),/*#__PURE__*/_jsx(Divider,{className:classes.divider}),/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle2\",children:[\"order ref: \",order.customer_reference]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,{component:Link,to:\"/\",variant:\"outlined\",type:\"button\",children:\"Back to Home\"})]}):isFinished?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",children:\"Thank you!\"}),/*#__PURE__*/_jsx(Divider,{className:classes.divider})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,{component:Link,to:\"/\",variant:\"outlined\",type:\"button\",children:\"Back to Home\"})]}):/*#__PURE__*/_jsx(\"div\",{className:classes.spinner,children:/*#__PURE__*/_jsx(CircularProgress,{})});};if(error){/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",children:[\"Error: \",error]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,{component:Link,to:\"/\",variant:\"outlined\",type:\"button\",children:\"Back to Home\"})]});}var Form=function Form(){return activeStep===0?/*#__PURE__*/_jsx(AddressForm,{checkoutToken:checkoutToken,next:next}):/*#__PURE__*/_jsx(PaymentForm,{shippingData:shippingData,checkoutToken:checkoutToken,nextStep:nextStep,backStep:backStep,onCaptureCheckout:onCaptureCheckout,timeout:timeout});};return/*#__PURE__*/_jsxs(\"div\",{style:{backgroundImage:\"url(\".concat('https://img.freepik.com/free-vector/stylish-hexagonal-line-pattern-background_1017-19742.jpg?size=626&ext=jpg',\")\")},children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsx(\"div\",{className:classes.toolbar}),/*#__PURE__*/_jsx(\"main\",{className:classes.layout,children:/*#__PURE__*/_jsxs(Paper,{className:classes.paper,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",align:\"center\",children:\"Checkout\"}),/*#__PURE__*/_jsx(Stepper,{activeStep:0,className:classes.stepper,children:steps.map(function(step){return/*#__PURE__*/_jsx(Step,{children:/*#__PURE__*/_jsx(StepLabel,{children:step})},step);})}),activeStep===steps.length?/*#__PURE__*/_jsx(Confirmation,{}):checkoutToken&&/*#__PURE__*/_jsx(Form,{})]})})]});};export default Checkout;","map":{"version":3,"sources":["/home/gmr/guiminr/E-Commerce-React/ecommerce/src/componets/CheckoutForm/Checkout/Checkout.jsx"],"names":["React","useState","useEffect","Paper","Stepper","Step","StepLabel","Typography","CircularProgress","Divider","Button","CssBaseline","Link","useHistory","commerce","useStyles","AddressForm","PaymentForm","steps","Checkout","cart","order","onCaptureCheckout","error","activeStep","setActiveStep","checkoutToken","setCheckoutToken","classes","shippingData","setShippingData","history","isFinished","setIsFinished","generateToken","checkout","id","type","token","pushState","nextStep","prevActiveStep","backStep","next","data","timeout","setTimeout","Confirmation","customer","firstname","lastname","divider","customer_reference","spinner","Form","backgroundImage","toolbar","layout","paper","stepper","map","step","length"],"mappings":"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","sourcesContent":["import React ,{ useState, useEffect } from 'react'\nimport { Paper, Stepper, Step, StepLabel, Typography, CircularProgress, Divider, Button, CssBaseline} from '@material-ui/core'\nimport { Link, useHistory} from 'react-router-dom';\nimport { commerce } from '../../../lib/commerce';\nimport useStyles from './styles';\nimport AddressForm from '../AddressForm';\nimport PaymentForm from '../PaymentForm';\n\n\nconst steps = ['Shipping address', 'Payment details'];\n\nconst Checkout = ({ cart, order, onCaptureCheckout, error }) => {\n    const [activeStep, setActiveStep] = useState(0);\n    const [checkoutToken, setCheckoutToken] = useState(null);\n    const classes = useStyles();\n    const [shippingData, setShippingData] = useState({});\n    const history = useHistory();\n    const [isFinished, setIsFinished] = useState(false);\n\n\n    useEffect(() => {\n        const generateToken = async () => {\n            try {\n                const token = await commerce.checkout.generateToken(cart.id, {type: 'cart' });\n                \n                setCheckoutToken(token);\n            } catch (error) {\n                history.pushState('/');\n            }\n        }\n\n        generateToken();\n    }, [cart])\n\n    const nextStep = () => setActiveStep((prevActiveStep) => prevActiveStep + 1);\n    const backStep = () => setActiveStep((prevActiveStep) => prevActiveStep - 1);\n\n\n    const next = (data) => {\n        setShippingData(data);\n        nextStep();\n    };\n\n    const timeout = () => {\n        setTimeout(() => {\n            setIsFinished(true);\n        }, 3000);\n    };\n    let Confirmation = () => order.customer ? (\n        <>\n        <div>\n            <Typography variant=\"h5\">Thank you! {order.customer.firstname} {order.customer.lastname}</Typography>\n            <Divider className={classes.divider}/>\n            <Typography variant=\"subtitle2\">order ref: {order.customer_reference}</Typography>\n        </div>\n        <br />\n        <Button component={Link} to=\"/\" variant=\"outlined\" type=\"button\">Back to Home</Button>\n        </>\n    ) : isFinished ? (\n        <>\n        <div>\n            <Typography variant=\"h5\">Thank you!</Typography>\n            <Divider className={classes.divider}/>\n        </div>\n        <br />\n        <Button component={Link} to=\"/\" variant=\"outlined\" type=\"button\">Back to Home</Button>\n        </>\n    ) : (\n        <div className={classes.spinner}>\n            <CircularProgress />\n        </div>\n    );\n\n    if (error) {\n        <>\n        <Typography variant=\"h5\">Error: {error}</Typography>\n        <br/>\n        <Button component={Link} to=\"/\" variant=\"outlined\" type=\"button\">Back to Home</Button>\n        </>\n    }\n    const Form = () => activeStep === 0 \n        ? <AddressForm checkoutToken={checkoutToken} next={next}/> : <PaymentForm shippingData={shippingData} checkoutToken={checkoutToken} nextStep={nextStep} backStep={backStep} onCaptureCheckout={onCaptureCheckout} timeout={timeout}/>\n    return (\n        <div style={{  backgroundImage: `url(${'https://img.freepik.com/free-vector/stylish-hexagonal-line-pattern-background_1017-19742.jpg?size=626&ext=jpg'})`}}>\n        <CssBaseline />\n         <div className={classes.toolbar}/>\n         <main className={classes.layout}>\n             <Paper className={classes.paper}>\n                <Typography variant=\"h4\" align=\"center\">Checkout</Typography>\n                <Stepper activeStep={0} className={classes.stepper}>\n                    {steps.map((step) => (\n                        <Step key={step}>\n                            <StepLabel>\n                                {step}\n                            </StepLabel>\n                        </Step>\n                    ))}\n                </Stepper>\n                { activeStep === steps.length ? <Confirmation /> : checkoutToken && <Form />}\n             </Paper>\n            </main>   \n        </div>\n    )\n}\n\nexport default Checkout\n"]},"metadata":{},"sourceType":"module"}